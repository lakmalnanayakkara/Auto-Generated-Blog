# 1. Use Node.js from AWS public ECR (no Docker Hub rate limit)
FROM public.ecr.aws/docker/library/node:20

# 2. Create app directory inside container
WORKDIR /app

# 3. Copy only package.json + package-lock.json first
COPY package*.json ./

# 4. Install dependencies (prod only)
RUN npm install --omit=dev

# 5. Copy the rest of project files
COPY . .

# 6. Expose backend port
EXPOSE 5000

# 7. Start the backend
CMD ["node", "src/server.js"]
